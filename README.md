# TAPD-é£ä¹¦å·¥æ—¶è¯„å®¡è‡ªåŠ¨åŒ–ç³»ç»Ÿ

## é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œç”¨äºå°† TAPD ä¸­çš„å·¥æ—¶è¯„å®¡é™„ä»¶ä¿¡æ¯è‡ªåŠ¨åŒæ­¥åˆ°é£ä¹¦å¤šç»´è¡¨æ ¼ä¸­ã€‚å½“å›¢é˜Ÿæˆå‘˜åœ¨ TAPD éœ€æ±‚è¯„è®ºä¸­ä¸Šä¼ ç¬¦åˆå‘½åè§„èŒƒçš„ Excel é™„ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§£æé™„ä»¶ä¿¡æ¯å¹¶åœ¨é£ä¹¦å¤šç»´è¡¨æ ¼ä¸­åˆ›å»ºç›¸åº”çš„è®°å½•ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”„ **è‡ªåŠ¨åŒæ­¥**: ç›‘å¬ TAPD é™„ä»¶ä¸Šä¼ äº‹ä»¶ï¼Œè‡ªåŠ¨åŒæ­¥åˆ°é£ä¹¦
- ğŸ“‹ **æ™ºèƒ½è§£æ**: è‡ªåŠ¨è§£æé™„ä»¶åç§°æ ¼å¼ï¼ˆå¦‚"å‰ç«¯-éœ€æ±‚å"ï¼‰
- ğŸ›¡ï¸ **å®‰å…¨å¯é **: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- ğŸš€ **é«˜æ€§èƒ½**: åŸºäº Node.js + TypeScript æ„å»º
- ğŸ“Š **æ•°æ®å®Œæ•´**: ä¿ç•™å®Œæ•´çš„éœ€æ±‚ä¿¡æ¯å’Œä¸Šä¼ è€…ä¿¡æ¯

## ç³»ç»Ÿæ¶æ„

```
TAPD é™„ä»¶ä¸Šä¼  â†’ è§¦å‘è‡ªåŠ¨åŒ–åŠ©æ‰‹ â†’ Webhook â†’ æœ¬ç³»ç»Ÿ â†’ é£ä¹¦å¤šç»´è¡¨æ ¼
```

## æŠ€æœ¯æ ˆ

- **åç«¯**: Node.js + TypeScript + Express
- **HTTP å®¢æˆ·ç«¯**: Axios
- **æ—¥å¿—**: Winston
- **é…ç½®ç®¡ç†**: dotenv
- **æ•°æ®éªŒè¯**: Joi
- **å®‰å…¨**: Helmet + CORS

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£…ï¼š
- Node.js (>= 16.0.0)
- npm æˆ– yarn

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å…¥ç›¸åº”é…ç½®ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š

```env
# æœåŠ¡é…ç½®
PORT=3000
NODE_ENV=development

# TAPD é…ç½®
TAPD_API_USER=your_tapd_api_user
TAPD_API_PASSWORD=your_tapd_api_password
TAPD_WORKSPACE_ID=your_workspace_id

# é£ä¹¦é…ç½®
FEISHU_APP_ID=your_feishu_app_id
FEISHU_APP_SECRET=your_feishu_app_secret
FEISHU_BASE_TOKEN=your_base_token
FEISHU_TABLE_ID=your_table_id

# Webhook å®‰å…¨é…ç½®
WEBHOOK_SECRET=your_webhook_secret
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

### 5. æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm start
```

## API ç«¯ç‚¹

- `GET /` - æœåŠ¡çŠ¶æ€ä¿¡æ¯
- `GET /health` - å¥åº·æ£€æŸ¥
- `POST /webhook/tapd` - TAPD Webhook æ¥æ”¶ç«¯ç‚¹

## é…ç½®è¯´æ˜

### TAPD é…ç½®

1. è·å– TAPD API æƒé™ï¼ˆéœ€è¦ä¼ä¸šç‰ˆï¼‰
2. åœ¨é¡¹ç›®è®¾ç½®ä¸­é…ç½®è‡ªåŠ¨åŒ–åŠ©æ‰‹
3. è®¾ç½®è§¦å‘æ¡ä»¶ä¸º"æ–°å¢é™„ä»¶"
4. è®¾ç½®æ‰§è¡ŒåŠ¨ä½œä¸ºè°ƒç”¨ Webhook

### é£ä¹¦é…ç½®

1. åœ¨é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨
2. è·å– App ID å’Œ App Secret
3. ç”³è¯·å¤šç»´è¡¨æ ¼ç›¸å…³æƒé™
4. è·å–ç›®æ ‡è¡¨æ ¼çš„ Base Token å’Œ Table ID

## é™„ä»¶å‘½åè§„èŒƒ

ç³»ç»Ÿä¼šè§£æä»¥ä¸‹æ ¼å¼çš„é™„ä»¶åç§°ï¼š
- `å‰ç«¯-éœ€æ±‚åç§°.xlsx`
- `åç«¯-éœ€æ±‚åç§°.xlsx`

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨
â”œâ”€â”€ services/        # ä¸šåŠ¡æœåŠ¡
â”œâ”€â”€ types/          # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”œâ”€â”€ middleware/     # ä¸­é—´ä»¶
â””â”€â”€ index.ts        # åº”ç”¨å…¥å£
```

## å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ TypeScript è¿›è¡Œç±»å‹å®‰å…¨å¼€å‘
- éµå¾ª ESLint è§„åˆ™
- ä½¿ç”¨ Prettier æ ¼å¼åŒ–ä»£ç 

### æµ‹è¯•

```bash
npm test
```

### æ—¥å¿—

æ—¥å¿—æ–‡ä»¶ä½äº `logs/` ç›®å½•ï¼š
- `app.log` - åº”ç”¨æ—¥å¿—
- `error.log` - é”™è¯¯æ—¥å¿—
- `exceptions.log` - å¼‚å¸¸æ—¥å¿—

## éƒ¨ç½²

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t tapd-feishu-automation .

# è¿è¡Œå®¹å™¨
docker run -d -p 3000:3000 --env-file .env tapd-feishu-automation
```

### PM2 éƒ¨ç½²

```bash
npm install -g pm2
npm run build
pm2 start dist/index.js --name tapd-feishu-automation
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç¯å¢ƒå˜é‡æœªé…ç½®**: æ£€æŸ¥ `.env` æ–‡ä»¶æ˜¯å¦æ­£ç¡®é…ç½®
2. **API æƒé™ä¸è¶³**: ç¡®è®¤ TAPD å’Œé£ä¹¦çš„ API æƒé™
3. **ç½‘ç»œè¿æ¥é—®é¢˜**: æ£€æŸ¥æœåŠ¡å™¨ç½‘ç»œå’Œé˜²ç«å¢™è®¾ç½®

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚
